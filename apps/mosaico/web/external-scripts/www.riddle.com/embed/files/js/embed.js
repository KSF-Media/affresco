!function(){var a;function e(e){var t=document.querySelectorAll('[data-rid-id="'+e+'"]'),i=t[0].getElementsByTagName("iframe")[0],n=document.getElementById("riddleFullScreenButton-"+e),d=document.body;null==a&&(a=t[0].style.width),0==window.riddleAPI.isFullScreen?function(e,t,i,n){var d="";e.requestFullscreen?(e.requestFullscreen(),d="fullscreenchange"):e.msRequestFullscreen?(e.msRequestFullscreen(),d="MSFullscreenChange"):e.mozRequestFullScreen?(e.mozRequestFullScreen(),d="mozfullscreenchange"):e.webkitRequestFullScreen&&(e.webkitRequestFullScreen(),d="webkitfullscreenchange");document.addEventListener(d,function(){l(t,i,n)})}(d,t[0],i,n):function(e,t,i){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen();l(e,t,i)}(t[0],i,n)}function l(e,t,i){document.fullscreenEnabled||document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement?(e.style.position="fixed",e.style.width="100%",e.style.top="0",e.style.left="0",e.style.background="#fff",e.style.setProperty("height","100%","important"),t.style.setProperty("height","100%","important"),i.style.position="fixed",i.style.bottom="20px",i.style.left="48%",window.riddleAPI.isFullScreen=!0):(e.style.position="static",e.style.top="0",e.style.left="0",e.style.width=a,e.style.setProperty("height","auto"),i.style.position="static",window.riddleAPI.isFullScreen=!1)}function t(){for(var e=document.body.getElementsByClassName("riddle_target");e.length;)i(e[0])}function i(e){e.className="riddle-target-initialised";var t="data-riddle-"+riddleAPI.riddles.length;e.setAttribute(t,"");var i=e.getElementsByTagName("iframe");if(0==i.length){var n=e.getAttribute("data-url")||e.getAttribute("data-game");if(!n)return;e.innerHTML+='<iframe src="'+n+'"></iframe>'}var d=i[0].style;if(d.border="none",d.width="100%",d.position="absolute",(d.opacity=0)==e.getElementsByClassName("rid-load").length){var a=e.getAttribute("data-fg")||"#1486cd",l=e.getAttribute("data-bg")||"#fff";e.insertAdjacentHTML("beforeend","<style>["+t+"] .rid-load {background: "+l+";}["+t+"] .rid-load i {background: "+a+';}.rid-load {border: 1px solid #cfcfcf!important;padding-top: 56%;border-radius: 5px;position: relative;}.rid-load p {position: absolute;top: 50%;left: 50%;margin: -8px}.rid-load i {position: absolute;width: 16px;height: 16px;border-radius: 3px;left: -25px;-webkit-animation: 1s infinite rid-icon;animation: 1s infinite rid-icon;-webkit-transform: scale(.4) rotate(62deg);transform: scale(.4) rotate(62deg);opacity: 0;}.rid-load i+i {-webkit-animation-delay: .17s;animation-delay: .17s;left: 0;}.rid-load i+i+i {-webkit-animation-delay: .34s;animation-delay: .34s;left: 25px;}@-webkit-keyframes rid-icon {50% {   opacity: 1;-webkit-transform: scale(1) rotate(62deg);}}@keyframes rid-icon {50% {opacity: 1;transform: scale(1) rotate(62deg);}}</style><div class="rid-load"><p><i></i><i></i><i></i></p></div>')}riddleAPI.riddles.push(e),u()}window.riddleAPI?"loading"!=document.readyState&&t():(window.riddleAPI={init:i,update:t,riddles:[],toggleFullScreen:e,isFullScreen:!1},window.addEventListener("message",d,!1),"loading"==document.readyState?document.addEventListener("DOMContentLoaded",t):t());var n=0;function u(){for(var e=0;e<riddleAPI.riddles.length;e++){var t=riddleAPI.riddles[e].getElementsByTagName("iframe")[0],i=t.getBoundingClientRect().top+window.scrollY||window.pageYOffset,n=window.scrollY||window.pageYOffset,d=n+window.innerHeight;t.contentWindow.postMessage({iframeOffetTop:i,viewtop:n,viewbottom:d},"*"),r(i,n,d,t)}}function r(e,t,i,n){if(null!=e&&null!=t&&null!=i&&n.src!=n.parentElement.getAttribute("data-embed-url")&&-1==n.src.indexOf("riddle.com")){var d=e+n.parentElement.getBoundingClientRect().height;(t<=e&&e<=i||t<=d&&d<=i)&&(n.src=n.parentElement.getAttribute("data-embed-url"))}}function m(){var e=document.documentElement;n=(window.pageYOffset||e.scrollTop)-(e.clientTop||0)}function d(e){if("object"==typeof e.data)for(var t=0;t<riddleAPI.riddles.length;t++){var i=riddleAPI.riddles[t],n=i.getElementsByTagName("iframe")[0];if(e.source==n.contentWindow){if(e.data.riddleHeight){var d=n.style;if(window.riddleAPI.isFullScreen||d.setProperty("height",e.data.riddleHeight+"px","important"),0==d.opacity){d.opacity=1,d.position="static";for(var a=riddleAPI.riddles[t].getElementsByClassName("rid-load");0<a.length;)a[0].parentNode.removeChild(a[0])}null!=window.parent&&window.parent.postMessage({riddleHeight:e.data.riddleHeight+55,riddleId:e.data.riddleId},"*"),-1!=window.location.href.indexOf("?")&&i.getElementsByTagName("iframe")[0].contentWindow.postMessage({riddleQueryString:window.location.href.split("?")[1]},"*"),i.getElementsByTagName("iframe")[0].contentWindow.postMessage({riddleParentLocation:window.location.href},"*"),u()}if(e.data.riddleEvent&&window.onRiddleEvent&&window.onRiddleEvent(e.data.riddleEvent,n),"page-change"!=e.data.riddleEvent||"false"==i.getAttribute("data-auto-scroll")||e.data.isUnrolledQuiz)"page-change"==e.data.riddleEvent&&"false"==i.getAttribute("data-auto-scroll")&&(m(),u());else{var l=0;isNaN(i.getAttribute("data-auto-scroll-offset"))||(l=i.getAttribute("data-auto-scroll-offset")),n.scrollIntoView(!0),window.scrollBy(0,-10-l),u()}if(e.data.riddleEvent&&"answer-poll"==e.data.riddleEvent.action&&"false"==i.getAttribute("data-auto-scroll")&&m(),null!=e.data.redirectToCustomLandingpagePath&&null!=e.data.redirectToCustomLandingpageData){var r=e.data.redirectToCustomLandingpagePath,o=e.data.redirectToCustomLandingpageData,s=window.parent.document.createElement("form");s.setAttribute("method","post"),s.setAttribute("action",r);var c=window.parent.document.createElement("input");c.setAttribute("type","hidden"),c.setAttribute("name","data"),c.setAttribute("value",o),s.appendChild(c),window.parent.document.body.appendChild(s),s.submit()}}}}document.addEventListener("scroll",function(e){0!=n&&(window.scrollTo(0,n),n=0),u()})}();
